<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="initial-scale=1, maximum-scale=1, user-scalable=no, width=device-width, shrink-to-fit=no">
    <style>
      html, body {
        margin: 0;
        width: 100%;
        height: 100%;
        overflow: hidden;
        background-color: #000;
      }

      a:link, a:visited{
        color: #bdc3c7;
      }

    </style>
  </head>

  <body>

    <div id="progress"></div>
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/105/three.min.js"></script>
    <script src="../build/panolens.js"></script>

    <script>

      var identifier1 = {
        moment_id: "5b08295bdcc6b400130d942a",
        variation: 101,
        public_api_key: "63b130be-2f20-40a2-8211-355b607f340a"
      };

      var identifier2 = {
        moment_id: "58a5d20affe5e3000bdb34c0",
        variation: 101,
        public_api_key: "63b130be-2f20-40a2-8211-355b607f340a"
      };
     
      var panomoment1 = new PANOLENS.PanoMomentPanorama( identifier1, { plane: true } );
      var panomoment2 = new PANOLENS.PanoMomentPanorama( identifier2 );
      var panorama1 = new PANOLENS.ImagePanorama( 'asset/textures/equirectangular/building.jpg', { plane: true } );
      var video1 = new PANOLENS.VideoPanorama( 'asset/textures/video/ClashofClans.mp4', { autoplay: true, muted: false, plane: true } );

      var viewer = new PANOLENS.Viewer( { output: 'console', autoHideInfospot: false, momentum: true, momentumFactor: 7.5 } );
      viewer.add( panomoment1, panomoment2, panorama1, video1 );

      var infospot = new PANOLENS.Infospot(0.1);
      infospot.position.set( 0,0,0 );
      infospot.addHoverText( 'Tony Hawk' );
      
      panomoment1.add( infospot );

      panomoment1.link( panomoment2, new THREE.Vector3( 0.4,-0.4,0 ), .1 );
      panomoment1.link( panorama1, new THREE.Vector3( -0.4,-0.4,0 ), .1 );
      panomoment1.link( video1, new THREE.Vector3( 0.4,0.4,0 ), .1 );
      panorama1.link( panomoment1, new THREE.Vector3( 0,0,0 ), .1 );
      panomoment2.link( panomoment1, new THREE.Vector3( 5000.00, -1635.54, -1325.98 ) );
      video1.link( panomoment1, new THREE.Vector3( 0,0,0), .1 );

      viewer.panorama.dispatchEvent( { 
          type: 'panolens-viewer-handler', 
          method: 'addUpdateCallback', 
          data: updateCallback
      });

      function updateCallback () {

        if (viewer.panorama == panomoment1) {
          var currentYaw = THREE.Math.radToDeg(viewer.camera.rotation.y) + 180;
          if (currentYaw <= 360 && currentYaw >= 140) {
            infospot.material.visible = true;
          } else if (currentYaw > 0 || currentYaw < 140) {
            infospot.material.visible = false;
          }
        }

      }

    </script>

  </body>
</html>